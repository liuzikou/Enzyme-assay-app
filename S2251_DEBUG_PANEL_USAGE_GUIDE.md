# S2251 调试面板使用指南

## 调试面板位置

S2251调试面板位于应用页面的以下位置：

```
应用页面布局：
┌─────────────────────────────────────┐
│ AppHeader (应用头部)                  │
├─────────────────────────────────────┤
│ InputPanel (输入面板)                │
├─────────────────────────────────────┤
│ PlotArea (时间序列图表)              │
├─────────────────────────────────────┤
│ PlateResultsGrid (结果表格)          │
├─────────────────────────────────────┤
│ S2251DebugPanel (调试面板) ⭐        │
├─────────────────────────────────────┤
│ ExportActions (导出选项)             │
└─────────────────────────────────────┘
```

## 显示条件

调试面板只有在以下条件都满足时才会显示详细的计算结果：

1. **选择S2251模式** - 在应用头部选择"S2251"模式
2. **输入数据** - 在输入面板中粘贴或上传数据
3. **选择控制孔** - 选择0%控制孔（如G11、G12）
4. **选择样本孔位** - 选择要分析的样本孔位
5. **执行计算** - 点击"计算"按钮

## 使用步骤

### 步骤1: 选择S2251模式
- 在应用头部的下拉菜单中选择"S2251"
- 调试面板会显示"请选择 S2251 模式以显示调试面板"

### 步骤2: 输入测试数据
您可以使用以下方式输入数据：

**方式1: 粘贴CSV数据**
```
Well ID,T0,T1,T2,T3,T4,T5,T6,T7,T8,T9
A1,0.100,0.105,0.112,0.120,0.128,0.137,0.146,0.156,0.167,0.178
A2,0.100,0.106,0.113,0.121,0.130,0.139,0.149,0.160,0.171,0.183
G11,0.100,0.100,0.100,0.100,0.100,0.100,0.100,0.100,0.100,0.100
G12,0.100,0.100,0.100,0.100,0.100,0.100,0.100,0.100,0.100,0.100
```

**方式2: 上传测试文件**
- 使用提供的测试文件：`public/s2251-test-data-simple.csv`

### 步骤3: 选择控制孔
- 在孔位选择网格中选择G11和G12作为0%控制孔
- 这些孔位的数据将用于背景扣除

### 步骤4: 选择样本孔位
- 选择要分析的样本孔位（如A1、A2等）
- 可以选择单个孔位或多个孔位

### 步骤5: 执行计算
- 点击"计算"按钮
- 等待计算完成

### 步骤6: 查看调试结果
计算完成后，调试面板将显示：

#### **调试状态**
- 原始数据数量
- 选择的孔位数量
- 控制孔数量
- 计算结果数量
- 当前选择的调试孔位
- 调试信息状态
- 平滑窗口大小

#### **计算步骤结果**
1. **步骤1: 重复孔平均值 (dup-mean)**
   - 重复孔数据（如果存在）
   - 计算后的平均值

2. **步骤2: 裂解率 (LR)**
   - 一阶差分计算结果
   - 数据长度

3. **步骤3: 平滑后裂解率 (smooth-LR)**
   - 平滑处理后的LR数据
   - 平滑窗口大小和数据长度

4. **步骤4: 净裂解率 (net-LR)**
   - 减去背景控制后的净裂解率
   - 数据长度

5. **步骤5: 最大值和位置**
   - 最大净裂解率值
   - 最大值在数组中的位置

6. **步骤6: 线性回归斜率 (PGR)**
   - 回归斜率
   - 科学计数法格式的PGR值

#### **数据可视化图表**
- 原始数据图表
- 重复孔数据图表（如果存在）
- 平均值数据图表
- 裂解率(LR)图表
- 平滑后裂解率图表
- 背景裂解率图表
- 净裂解率(net-LR)图表

#### **辅助信息**
- 控制孔信息
- 线性回归数据
- 验证信息

## 手动操作

### 选择不同孔位
- 在调试面板的下拉菜单中选择不同的孔位
- 调试信息会自动更新

### 重新计算
- 点击"重新计算"按钮重新计算当前孔位
- 点击"强制计算"按钮强制计算第一个孔位

## 故障排除

### 调试面板不显示
1. **检查模式选择** - 确保选择了"S2251"模式
2. **检查数据输入** - 确保已输入有效数据
3. **检查控制孔选择** - 确保选择了0%控制孔
4. **检查样本孔位选择** - 确保选择了要分析的孔位
5. **检查计算状态** - 确保已执行计算

### 调试信息显示"未加载"
1. **检查控制台日志** - 打开浏览器开发者工具查看错误信息
2. **检查数据格式** - 确保数据格式正确
3. **尝试手动计算** - 使用"强制计算"按钮
4. **检查控制孔数据** - 确保控制孔有有效数据

### 计算结果异常
1. **检查数据质量** - 确保输入数据没有异常值
2. **调整平滑窗口** - 尝试不同的平滑窗口大小
3. **检查控制孔选择** - 确保选择了正确的控制孔
4. **验证数据长度** - 确保所有孔位的数据长度一致

## 测试数据

您可以使用以下测试数据快速验证调试面板功能：

### 简单测试数据
```
Well ID,T0,T1,T2,T3,T4,T5,T6,T7,T8,T9
A1,0.100,0.105,0.112,0.120,0.128,0.137,0.146,0.156,0.167,0.178
A2,0.100,0.106,0.113,0.121,0.130,0.139,0.149,0.160,0.171,0.183
G11,0.100,0.100,0.100,0.100,0.100,0.100,0.100,0.100,0.100,0.100
G12,0.100,0.100,0.100,0.100,0.100,0.100,0.100,0.100,0.100,0.100
```

### 预期结果
- **A1孔位PGR**: 约 `6.31e-4`
- **A2孔位PGR**: 约 `6.67e-4`
- **平滑窗口=3**: 数据长度从9减少到7
- **最大值位置**: 通常在索引6附近

## 总结

S2251调试面板提供了完整的计算过程可视化，让您可以：

1. ✅ **验证计算步骤** - 查看每个计算步骤的中间结果
2. ✅ **调试数据问题** - 识别数据异常和计算错误
3. ✅ **优化参数设置** - 调整平滑窗口等参数
4. ✅ **验证结果正确性** - 确保PGR计算的准确性

调试面板是S2251算法开发和验证的重要工具，提供了详细的计算过程透明度和调试能力。
