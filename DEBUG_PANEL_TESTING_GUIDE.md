# S2251 调试面板测试指南

## 问题诊断

调试面板没有显示各步骤计算结果的常见原因：

### 1. 检查应用状态
- ✅ 应用正在运行: `http://localhost:5173`
- ✅ 调试面板代码已更新
- ✅ 异步导入问题已修复

### 2. 调试面板显示条件
调试面板只有在以下条件都满足时才会显示详细的计算结果：

1. **选择S2251模式** - 在应用头部选择"S2251"
2. **输入数据** - 在输入面板中粘贴或上传数据
3. **选择控制孔** - 选择0%控制孔（如G11、G12）
4. **选择样本孔位** - 选择要分析的样本孔位
5. **执行计算** - 点击"计算"按钮

### 3. 测试步骤

#### 步骤1: 选择S2251模式
1. 打开 `http://localhost:5173`
2. 在应用头部的下拉菜单中选择"S2251"
3. 调试面板应该显示"请选择 S2251 模式以显示调试面板"

#### 步骤2: 输入测试数据
使用以下测试数据：

**方式1: 粘贴CSV数据**
```
Well ID,T0,T1,T2,T3,T4,T5,T6,T7,T8,T9
A1,0.100,0.105,0.112,0.120,0.128,0.137,0.146,0.156,0.167,0.178
A2,0.100,0.106,0.113,0.121,0.130,0.139,0.149,0.160,0.171,0.183
G11,0.100,0.100,0.100,0.100,0.100,0.100,0.100,0.100,0.100,0.100
G12,0.100,0.100,0.100,0.100,0.100,0.100,0.100,0.100,0.100,0.100
```

**方式2: 上传测试文件**
- 使用文件: `public/s2251-test-data-simple.csv`

#### 步骤3: 选择控制孔
1. 在孔位选择网格中选择G11和G12作为0%控制孔
2. 这些孔位的数据将用于背景扣除

#### 步骤4: 选择样本孔位
1. 选择要分析的样本孔位（如A1、A2等）
2. 可以选择单个孔位或多个孔位

#### 步骤5: 执行计算
1. 点击"计算"按钮
2. 等待计算完成

#### 步骤6: 查看调试结果
计算完成后，调试面板应该显示：

- **调试状态** - 显示数据数量、选择状态等
- **计算步骤结果** - 显示6个计算步骤的详细结果
- **数据可视化图表** - 显示各种数据的图表
- **辅助信息** - 控制孔信息、线性回归数据等

### 4. 故障排除

#### 调试面板显示"调试信息未加载"
1. **检查浏览器控制台** - 按F12打开开发者工具，查看Console标签页
2. **检查错误信息** - 查找红色的错误信息
3. **尝试手动计算** - 点击"强制计算"按钮
4. **检查数据格式** - 确保CSV数据格式正确

#### 调试面板完全不显示
1. **检查模式选择** - 确保选择了"S2251"模式
2. **检查数据输入** - 确保已输入有效数据
3. **检查控制孔选择** - 确保选择了0%控制孔
4. **检查样本孔位选择** - 确保选择了要分析的孔位

#### 计算步骤结果为空
1. **检查控制台日志** - 查看是否有计算错误
2. **检查数据质量** - 确保输入数据没有异常值
3. **检查控制孔数据** - 确保控制孔有有效数据
4. **尝试重新计算** - 点击"重新计算"按钮

### 5. 预期结果

使用上述测试数据，您应该看到：

- **A1孔位PGR**: 约 `6.31e-4`
- **A2孔位PGR**: 约 `6.67e-4`
- **平滑窗口=3**: 数据长度从9减少到7
- **最大值位置**: 通常在索引6附近

### 6. 调试信息结构

调试面板应该显示以下信息：

1. **步骤1: 重复孔平均值 (dup-mean)**
   - 重复孔数据（如果存在）
   - 计算后的平均值

2. **步骤2: 裂解率 (LR)**
   - 一阶差分计算结果
   - 数据长度

3. **步骤3: 平滑后裂解率 (smooth-LR)**
   - 平滑处理后的LR数据
   - 平滑窗口大小和数据长度

4. **步骤4: 净裂解率 (net-LR)**
   - 减去背景控制后的净裂解率
   - 数据长度

5. **步骤5: 最大值和位置**
   - 最大净裂解率值
   - 最大值在数组中的位置

6. **步骤6: 线性回归斜率 (PGR)**
   - 回归斜率
   - 科学计数法格式的PGR值

### 7. 手动测试

如果自动计算不工作，您可以：

1. **点击"强制计算"按钮** - 强制计算第一个孔位
2. **点击"重新计算"按钮** - 重新计算当前选择的孔位
3. **选择不同孔位** - 在下拉菜单中选择不同的孔位

### 8. 联系支持

如果问题仍然存在，请：

1. **截图调试状态** - 显示调试面板的当前状态
2. **提供控制台错误** - 复制浏览器控制台的错误信息
3. **提供测试数据** - 说明使用的数据格式和内容

调试面板是S2251算法开发和验证的重要工具，应该能够显示完整的计算过程。
